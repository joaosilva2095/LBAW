var green="#DFF0D8";var red="#A94442";function registerUser(){var b=$("#identification").val();var d=$("#role").val();var e=$("#email").val();var h=$("#password").val();var a=$("#name").val();var g=$("#gender").val();var k=$("#birthdate").val();var j=$("#nif").val();var i=$("#cellphone").val();var c=$("#paymethod").val();var f=$("#periodicity").val();if(d!="Amigo"){j=" ";i=" ";c=" ";f=" "}$.post("../api/register_user.php",{id:b,role:d,email:e,password:h,name:a,gender:g,birth:k,nif:j,cellphone:i,donative_type:c,periodicity:f},function(n,o,p){$("#userModal").modal("hide");var m=$("#users tr:last");var l=m.clone();l.attr("id","user"+b);m.after(l);$("#user"+b+" td:nth-child(1)").html(b);$("#user"+b+" td:nth-child(2)").html(a);$("#user"+b+" td:nth-child(3)").html(e);$("#user"+b+" td:nth-child(4)").html(g);$("#user"+b+" td:nth-child(5)").html(k);$("#user"+b+" td:nth-child(6)").html(i);$("#user"+b+" td:nth-child(7)").html(j);$("#user"+b+" td:nth-child(8)").html(c);$("#user"+b+" td:nth-child(9)").html(f);$("#user"+b+" td:nth-child(10)").html(d);l.highlightAnimation(green,1500);$('i[data-original-title="Eliminar"]').click(removeUser);enableTooltips()}).fail(function(l){$("#userStatus").fadeIn()})}function removeUser(){var a=$(this).closest("tr").attr("id");a=a.replace("user","");$.post("../api/delete_user.php",{id:a},function(b,c,d){$("#user"+a).remove()}).fail(function(b){$("#user"+a).highlightAnimation(red,1500)})}function togglePauseUser(){var a=$(this).closest("tr").attr("id");a=a.replace("user","");$.post("../api/pause_user.php",{id:a},function(d,e,f){var b=$("#user"+a);var c=$("#user"+a+"-frozen");if(b.hasClass("warning")){b.removeClass("warning");c.removeClass("fa-play");c.addClass("fa-pause");c.tooltip("hide").attr("data-original-title","Congelar").tooltip("fixTitle")}else{b.addClass("warning");c.removeClass("fa-pause");c.addClass("fa-play");c.tooltip("hide").attr("data-original-title","Descongelar").tooltip("fixTitle")}}).fail(function(b){$("#user"+a).highlightAnimation(red,1500)})}function updateUser(){var b=$("#identification").val();var d=$("#role").val();var e=$("#email").val();var h=$("#password").val();var a=$("#name").val();var g=$("#gender").val();var k=$("#birthdate").val();var j=$("#nif").val();var i=$("#cellphone").val();var c=$("#paymethod").val();var f=$("#periodicity").val();if(d!="Amigo"){j=" ";i=" ";c=" ";f=" "}$.post("../api/edit_user.php",{id:b,role:d,email:e,name:a,gender:g,birth:k,nif:j,cellphone:i,donative_type:c,periodicity:f},function(l,m,n){$("#userModal").modal("hide");$("#user"+b+" td:nth-child(1)").html(b);$("#user"+b+" td:nth-child(2)").html(a);$("#user"+b+" td:nth-child(3)").html(e);$("#user"+b+" td:nth-child(4)").html(g);$("#user"+b+" td:nth-child(5)").html(k);$("#user"+b+" td:nth-child(6)").html(i);$("#user"+b+" td:nth-child(7)").html(j);$("#user"+b+" td:nth-child(8)").html(c);$("#user"+b+" td:nth-child(9)").html(f);$("#user"+b+" td:nth-child(10)").html(d);$("#user"+b).highlightAnimation(green,1500)}).fail(function(l){$("#userStatus").fadeIn()})}function enableTooltips(){$('[data-toggle="tooltip"]').tooltip({placement:"top"})}function configEditUserModal(){$("#userModal form").trigger("reset");$("#userModalTitle").html("Editar Utilizador");var b=$(this).closest("tr").attr("id");b=b.replace("user","");var a=$("#user"+b+" td:nth-child(2)").text();var e=$("#user"+b+" td:nth-child(3)").text();var g=$("#user"+b+" td:nth-child(4)").text();var j=$("#user"+b+" td:nth-child(5)").text();var i=$("#user"+b+" td:nth-child(6)").text();var h=$("#user"+b+" td:nth-child(7)").text();var c=$("#user"+b+" td:nth-child(8)").text();var f=$("#user"+b+" td:nth-child(9)").text();var d=$("#user"+b+" td:nth-child(10)").text();$('label[for="password"]').hide();$("#password").hide();if(d=="Amigo"){$("#friendOnlyParams").show()}else{$("#friendOnlyParams").hide()}$("#identification").attr("disabled","disabled");$("#identification").val(b);$("#name").val(a);$("#email").val(e);$("#gender").val(g);$("#birthdate").val(j);$("#role").val(d);$("#nif").val(h);$("#cellphone").val(i);$("#paymethod").val(c);$("#periodicity").val(f)}function configNewUserModal(){$("#userModal form").trigger("reset");$("#friendOnlyParams").fadeIn();$('label[for="password"]').show();$("#password").show();$("#identification").removeAttr("disabled");$("#userModalTitle").html("Novo Utilizador")}$.fn.highlightAnimation=function(e,c){var d=e||"#DFF0D8";var a=c||1500;var b=this.css("background-color");this.stop().css("background-color",d).animate({backgroundColor:b},a)};$(document).ready(function(){enableTooltips();$("#newUser").click(configNewUserModal);$("#userSubmit").click(function(){if($("#userModalTitle").text()=="Novo Utilizador"){registerUser()}else{updateUser()}});$('i[data-original-title="Editar"]').click(configEditUserModal);$('i[data-original-title="Eliminar"]').click(removeUser);$('i[data-original-title="Congelar"]').click(togglePauseUser);$('i[data-original-title="Descongelar"]').click(togglePauseUser);$("#userStatus").click(function(){$(this).fadeOut()});$("#role").change(function(){var a=$("#role").val();if(a==="Amigo"){$("#friendOnlyParams").fadeIn()}else{$("#friendOnlyParams").fadeOut()}})});